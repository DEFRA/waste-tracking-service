import Ajv from 'ajv/dist/jtd';
import {
  ContentProcessingTask,
  ContentSubmissionTask,
  ContentToBeProcessedTask,
  ContentToBeSubmittedTask,
} from '../model';
import {
  contentSubmissionTask,
  contentProcessingTask,
  contentToBeProcessedTask,
  contentToBeSubmittedTask,
} from './task-schema';

const ajv = new Ajv();

describe('contentProcessingTask', () => {
  const validate = ajv.compile<ContentProcessingTask>(contentProcessingTask);

  it('is compatible with dto values', () => {
    const value: ContentProcessingTask = {
      accountId: '964cc80b-da90-4675-ac05-d4d1d79ac888',
      batchId: '864cc80b-da90-4675-ac05-d4d1d79ac888',
      content: {
        type: 'text/csv',
        compression: 'Snappy',
        value:
          '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',
      },
    };

    expect(validate(value)).toBe(true);
  });
});

describe('contentToBeProcessedTask', () => {
  const validate = ajv.compile<ContentToBeProcessedTask>(
    contentToBeProcessedTask,
  );

  it('is compatible with dto values', () => {
    const value: ContentToBeProcessedTask = {
      id: '8b938d50-6a08-43b1-b572-cdfedae6f826',
      time: '2024-02-02T16:55:28.993Z',
      type: 'service-uk-waste-movements-bulk.event.sent.ContentToBeProcessed',
      source: 'service-uk-waste-movements-bulk.addContentToBatch',
      specversion: '1.0',
      datacontenttype: 'application/cloudevents+json',
      pubsubname: 'SNDWTSINFASB1401.servicebus.windows.net',
      queue: 'service-uk-waste-movements-bulk-tasks',
      traceparent: '00-695431221b6ecb0a539d7c2826765ddf-f8ee95a60beecd0c-01',
      tracestate: '',
      data: {
        accountId: '964cc80b-da90-4675-ac05-d4d1d79ac888',
        batchId: '864cc80b-da90-4675-ac05-d4d1d79ac888',
        content: {
          type: 'text/csv',
          compression: 'Snappy',
          value:
            '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',
        },
      },
    };

    expect(validate(value)).toBe(true);
  });
});

describe('contentSubmissionTask', () => {
  const validate = ajv.compile<ContentSubmissionTask>(contentSubmissionTask);

  it('is compatible with dto values', () => {
    const value: ContentSubmissionTask = {
      accountId: '964cc80b-da90-4675-ac05-d4d1d79ac888',
      batchId: '864cc80b-da90-4675-ac05-d4d1d79ac888',
    };

    expect(validate(value)).toBe(true);
  });
});

describe('contentToBeProcessedTask', () => {
  const validate = ajv.compile<ContentToBeSubmittedTask>(
    contentToBeSubmittedTask,
  );

  it('is compatible with dto values', () => {
    const value: ContentToBeSubmittedTask = {
      id: '8b938d50-6a08-43b1-b572-cdfedae6f826',
      time: '2024-02-02T16:55:28.993Z',
      type: 'service-uk-waste-movements-bulk.event.sent.ContentToBeProcessed',
      source: 'service-uk-waste-movements-bulk.addContentToBatch',
      specversion: '1.0',
      datacontenttype: 'application/cloudevents+json',
      pubsubname: 'SNDWTSINFASB1401.servicebus.windows.net',
      queue: 'service-uk-waste-movements-bulk-tasks',
      traceparent: '00-695431221b6ecb0a539d7c2826765ddf-f8ee95a60beecd0c-01',
      tracestate: '',
      data: {
        accountId: '964cc80b-da90-4675-ac05-d4d1d79ac888',
        batchId: '864cc80b-da90-4675-ac05-d4d1d79ac888',
      },
    };

    expect(validate(value)).toBe(true);
  });
});
